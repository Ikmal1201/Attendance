<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Sheets Integration</title>
  <!-- Include the Google Sheets API script -->
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

  <h1>Google Sheets Integration</h1>

  <!-- Your HTML form -->
  <form id="myForm">
    <label for="dari-mana">DARI MANA / SPHU:</label>
        <input type="text" name="dari_mana" required>

        <label for="jumlah-bayaran">JUMLAH BAYARAN:</label>
        <input type="text" name="jumlah_bayaran" required>

        <label for="nama">NAMA:</label>
        <input type="text" name="nama" required>

        <label for="no-tel">NO. TEL:</label>
        <input type="text" name="no_tel" required>

        <label for="emel">EMEL:</label>
        <input type="email" name="emel" required>

        <label for="daerah">DAERAH:</label>
        <input type="text" name="daerah" required>

        <label for="mukim">mukim:</label>
        <input type="text" name="mukim" required>

        <label for="alamat">ALAMAT:</label>
        <textarea name="alamat" required></textarea>

        <label for="negeri">NEGERI:</label>
        <input type="text" name="negeri" required>

        <label for="id-ejen">ID EJEN/ UPLINE:</label>
        <input type="text" name="id_ejen" required>

        <label for="text-field">text:</label>
        <input type="text" name="text_field" required>

        <label for="catatan">CATATAN:</label>
        <textarea name="catatan"></textarea>

        <label>Attendance:</label>
        <input type="checkbox" name="attendance[]" value="Induksi 1.0"> Induksi 1.0
        <input type="checkbox" name="attendance[]" value="Induksi 2.0"> Induksi 2.0
        <input type="checkbox" name="attendance[]" value="Induksi 3.0"> Induksi 3.0
        <input type="checkbox" name="attendance[]" value="Induksi 4.0"> Induksi 4.0
        <input type="checkbox" name="attendance[]" value="Induksi 5.0"> Induksi 5.0
        <input type="checkbox" name="attendance[]" value="Induksi 6.0"> Induksi 6.0

        <label for="coaching-cvo">coaching cvo:</label>
        <input type="text" name="coaching_cvo">

        <label for="preview">preview:</label>
        <input type="text" name="preview">

        <label for="kekerapan-kehadiran">KEKERAPAN KEHADIRAN:</label>
        <input type="text" name="kekerapan_kehadiran">

    <input type="submit" value="Submit">
  </form>

  <!-- Your JavaScript code -->
  <script>
    // Function to handle form submission
    function handleFormSubmit(event) {
      // Prevent the default form submission
      event.preventDefault();

      // Get form data
      var data = {
        dari_mana: document.getElementById('dari_mana').value,
        jumlah_bayaran: document.getElementById('jumlah_bayaran').value,
        nama: document.getElementById('nama').value,
        // Add other form fields here
      };

      // Initialize the Google Sheets API client
      gapi.load('client', initClient);

      function initClient() {
        // Ensure API key is set (replace with your API key)
        var apiKey = 'AIzaSyCurYijbFJ7ytN3qFpxf90COUIYJXMul8Q';
        if (!apiKey) {
          console.error('API key missing. Please replace "YOUR_GOOGLE_SHEETS_API_KEY" with your API key.');
          return;
        }

        // Initialize the API client with the API key and Sheets API discovery docs
        gapi.client.init({
          apiKey: apiKey,
          discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
        }).then(function() {
          // Call the function to append data to the sheet
          appendDataToSheet(data);
        });
      }

      // Function to append data to the Google Sheet
      function appendDataToSheet(data) {
        // Specify your spreadsheet ID and range
        var spreadsheetId = '15lGgRd3BRda7iBIibPmj9SzynV6NYSrTETmfKiyx4TY';
        var range = 'DATA LENGKAP MC';

        // Prepare the values for the API request
        var values = [Object.values(data)];

        // Append the data to the sheet
        gapi.client.sheets.spreadsheets.values.append({
          spreadsheetId: spreadsheetId,
          range: range,
          valueInputOption: 'RAW',
          insertDataOption: 'INSERT_ROWS',
          resource: {
            values: values,
          },
        }).then(function(response) {
          var result = response.result;
          console.log(result);

          if (result.updates && result.updates.updatedRows > 0) {
            console.log('Data submitted successfully!');
          } else {
            console.error('Error submitting data.');
          }
        }, function(reason) {
          console.error('Error: ' + reason.result.error.message);
        });
      }
    }

    // Attach the form submission handler
    document.getElementById('myForm').addEventListener('submit', handleFormSubmit);
  </script>

</body>
</html>
