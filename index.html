<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kehadiran</title>
   <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 20px;
            padding: 20px;
            background-color: #f4f4f4;
        }

        form {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        input,
        textarea {
            width: 100%;
            padding: 8px;
            margin-bottom: 12px;
            box-sizing: border-box;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        textarea {
            resize: vertical;
        }

        button {
            background-color: #4caf50;
            color: #fff;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #45a049;
        }

        input[type="checkbox"] {
            margin-bottom: 6px;
            margin-right: 5px;
        }
    </style>
  <!-- Include the Google Sheets API script -->
  <script src="https://apis.google.com/js/api.js"></script>
</head>
<body>

  <h1>Google Sheets Integration</h1>

  <!-- Your HTML form -->
  <form id="myForm">
    <label for="dari-mana">DARI MANA / SPHU:</label>
        <input type="text" name="dari_mana" required>

        <label for="jumlah-bayaran">JUMLAH BAYARAN:</label>
        <input type="text" name="jumlah_bayaran" required>

        <label for="nama">NAMA:</label>
        <input type="text" name="nama" required>

        <label for="no-tel">NO. TEL:</label>
        <input type="text" name="no_tel" required>

        <label for="emel">EMEL:</label>
        <input type="email" name="emel" required>

        <label for="daerah">DAERAH:</label>
        <input type="text" name="daerah" required>

        <label for="mukim">mukim:</label>
        <input type="text" name="mukim" required>

        <label for="alamat">ALAMAT:</label>
        <textarea name="alamat" required></textarea>

        <label for="negeri">NEGERI:</label>
        <input type="text" name="negeri" required>

        <label for="id-ejen">ID EJEN/ UPLINE:</label>
        <input type="text" name="id_ejen" required>

        <label for="text-field">text:</label>
        <input type="text" name="text_field" required>

        <label for="catatan">CATATAN:</label>
        <textarea name="catatan"></textarea>

        <label>Attendance:</label>
        <input type="checkbox" name="attendance[]" value="Induksi 1.0"> Induksi 1.0
        <input type="checkbox" name="attendance[]" value="Induksi 2.0"> Induksi 2.0
        <input type="checkbox" name="attendance[]" value="Induksi 3.0"> Induksi 3.0
        <input type="checkbox" name="attendance[]" value="Induksi 4.0"> Induksi 4.0
        <input type="checkbox" name="attendance[]" value="Induksi 5.0"> Induksi 5.0
        <input type="checkbox" name="attendance[]" value="Induksi 6.0"> Induksi 6.0

        <label for="coaching-cvo">coaching cvo:</label>
        <input type="text" name="coaching_cvo">

        <label for="preview">preview:</label>
        <input type="text" name="preview">

        <label for="kekerapan-kehadiran">KEKERAPAN KEHADIRAN:</label>
        <input type="text" name="kekerapan_kehadiran">

    <input type="submit" value="Submit">
  </form>

  <!-- Your JavaScript code -->
<script>
  function handleFormSubmit() {
    // Get form data
    var data = {
      dari_mana: document.getElementById('dari_mana').value,
      jumlah_bayaran: document.getElementById('jumlah_bayaran').value,
      nama: document.getElementById('nama').value,
      no_tel: document.getElementById('no_tel').value,
      emel: document.getElementById('emel').value,
      daerah: document.getElementById('daerah').value,
      mukim: document.getElementById('mukim').value,
      alamat: document.getElementById('alamat').value,
      negeri: document.getElementById('negeri').value,
      id_ejen: document.getElementById('id_ejen').value,
      text_field: document.getElementById('text_field').value,
      catatan: document.getElementById('catatan').value,
      attendance: getCheckedCheckboxesForArray('attendance'),
      coaching_cvo: document.getElementById('coaching_cvo').value,
      preview: document.getElementById('preview').value,
      kekerapan_kehadiran: document.getElementById('kekerapan_kehadiran').value
    };

    // Initialize the Google Sheets API
    gapi.load('client', initClient);

    function initClient() {
      gapi.client.init({
        apiKey: 'AIzaSyCurYijbFJ7ytN3qFpxf90COUIYJXMul8Q',
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
      }).then(function() {
        // Call the function to append data to the sheet
        appendDataToSheet(data);
      });
    }

    function appendDataToSheet(data) {
      // Specify your spreadsheet ID and range
      var spreadsheetId = '1OgOhnn3t3zg0Ixo4N0ySDgQ-WwbiA_NcYFZWuDogHes';
      var range = 'DATA LENGKAP MC';

      // Prepare the values for the API request
      var values = [Object.values(data)];

      // Append the data to the sheet
      gapi.client.sheets.spreadsheets.values.append({
        spreadsheetId: spreadsheetId,
        range: range,
        valueInputOption: 'RAW',
        insertDataOption: 'INSERT_ROWS',
        resource: {
          values: values,
        },
      }).then(function(response) {
        var result = response.result;
        console.log(result);

        if (result.updates && result.updates.updatedRows > 0) {
          console.log('Data submitted successfully!');
        } else {
          console.error('Error submitting data.');
        }
      }, function(reason) {
        console.error('Error: ' + reason.result.error.message);
      });
    }

    // Helper function to get values of checked checkboxes into an array
    function getCheckedCheckboxesForArray(checkboxName) {
      var checkboxes = document.querySelectorAll(`input[name="${checkboxName}"]:checked`);
      return Array.from(checkboxes).map(checkbox => checkbox.value);
    }
  }
</script>



</body>
</html>
